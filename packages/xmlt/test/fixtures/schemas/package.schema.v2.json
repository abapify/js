{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "SAP ADT Package XML Structure (Pattern-Based)",
  "description": "Lightweight schema using xpath patterns for XML reconstruction",

  "xmlMetadata": {
    "namespaces": {
      "pak": "http://www.sap.com/adt/packages",
      "adtcore": "http://www.sap.com/adt/core",
      "atom": "http://www.w3.org/2005/Atom"
    },

    "rules": [
      {
        "comment": "Root package element gets pak: namespace",
        "match": "/package",
        "namespace": "pak",
        "namespaceDeclarations": ["pak", "adtcore"]
      },
      {
        "comment": "All attributes on root package get adtcore: prefix",
        "match": "/package/@*",
        "namespace": "adtcore",
        "type": "attribute"
      },
      {
        "comment": "All direct children of package get pak: namespace",
        "match": "/package/*",
        "namespace": "pak"
      },
      {
        "comment": "Link elements get atom: namespace and declare it",
        "match": "//link",
        "namespace": "atom",
        "namespaceDeclaration": "atom"
      },
      {
        "comment": "Nested properties become attributes",
        "match": "/package/*/(@*|*[not(*)])",
        "type": "attribute",
        "namespace": "pak"
      },
      {
        "comment": "superPackage attributes use adtcore",
        "match": "/package/superPackage/@*",
        "namespace": "adtcore"
      },
      {
        "comment": "packageRef attributes use adtcore",
        "match": "//packageRef/@*",
        "namespace": "adtcore"
      }
    ],

    "elementOrder": [
      "link",
      "attributes",
      "superPackage",
      "applicationComponent",
      "transport",
      "useAccesses",
      "packageInterfaces",
      "subPackages"
    ]
  }
}
